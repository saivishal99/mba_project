<head>
<link rel = "stylesheet" type = "text/css" href =" stylesheet.css">
<script>
var total= 10000;
var curShare1= 0, curShare2= 0, curShare3= 0, curShare4= 0;
var xVal = 0;
var yVal1 = 0, yVal2= 0, yVal3= 0, yVal4= 0; 
var updateInterval = 20000;
var dataLength = 10; // number of dataPoints visible at any point

var data= [];
var dcount= 0;

function saveData() {
	let dataout = "data:text/csv;charset=utf-8,";
	dataout+= "Type,Share,ShareValue,Count\n";
	for (var i= 0; i < data.length; i++) {
		dataout+= (data[i]['type']+","+data[i]['share']+","+data[i]['shareValue']+","+data[i]['count']+"\n");
	}
	var encodedUri = encodeURI(dataout);
	window.open(encodedUri);
}

function buyShare1() {
	var buyA= parseInt(document.getElementById('BuyA').value);
	if (xVal == 0) {
		document.getElementById('BuyA').value= 0;
		return;
	}
	var cost= yVal1*buyA;
	if (cost < total) {
		total-= cost;
		curShare1+= buyA;
		document.getElementById('total').value=total;
		document.getElementById('BuyA').value= 0;
		document.getElementById('curShare1Out').value= curShare1;
		data.push({type:"buy",share:"A",shareValue:yVal1,count:buyA});
		dcount++;
	}
}

function sellShare1() {
	var sellA= parseInt(document.getElementById('SellA').value);
	if (curShare1 < sellA) {
		alert("Current share stock not enough!!!");
		document.getElementById('SellA').value= 0;
		return;
	}
	var sellPrice= sellA*yVal1;
	total+= sellPrice;
	curShare1-= sellA;
	document.getElementById('curShare1Out').value= curShare1;
	document.getElementById('SellA').value= 0;
	data.push({type:"sell",share:"A",shareValue:yVal1,count:sellA});
	dcount++;
}

function buyShare2() {
	var buyB= parseInt(document.getElementById('BuyB').value);
	if (xVal == 0) {
		document.getElementById('BuyB').value= 0;
		return;
	}
	var cost= yVal2*buyB;
	if (cost < total) {
		total-= cost;
		curShare2+= buyB;
		document.getElementById('total').value=total;
		document.getElementById('BuyB').value= 0;
		document.getElementById('curShare2Out').value= curShare2;
		data.push({type:"buy",share:"B",shareValue:yVal2,count:buyB});
		dcount++;
	}
}

function sellShare2() {
	var sellB= parseInt(document.getElementById('SellB').value);
	if (curShare2 < sellB) {
		alert("Current share stock not enough!!!");
		document.getElementById('SellB').value= 0;
		return;
	}
	var sellPrice= sellB*yVal2;
	total+= sellPrice;
	curShare2-= sellB;
	document.getElementById('curShare2Out').value= curShare2;
	document.getElementById('SellB').value= 0;
	data.push({type:"sell",share:"B",shareValue:yVal2,count:sellB});
	dcount++;
}

function buyShare3() {
	var buyC= parseInt(document.getElementById('BuyC').value);
	if (xVal == 0) {
		document.getElementById('BuyC').value= 0;
		return;
	}
	var cost= yVal3*buyC;
	if (cost < total) {
		total-= cost;
		curShare3+= buyC;
		document.getElementById('total').value=total;
		document.getElementById('BuyC').value= 0;
		document.getElementById('curShare3Out').value= curShare3;
		data.push({type:"buy",share:"C",shareValue:yVal3,count:buyC});
		dcount++;
	}
}

function sellShare3() {
	var sellC= parseInt(document.getElementById('SellC').value);
	if (curShare3 < sellC) {
		alert("Current share stock not enough!!!");
		document.getElementById('SellC').value= 0;
		return;
	}
	var sellPrice= sellC*yVal3;
	total+= sellPrice;
	curShare3-= sellC;
	document.getElementById('curShare3Out').value= curShare3;
	document.getElementById('SellC').value= 0;
	data.push({type:"sell",share:"C",shareValue:yVal3,count:sellC});
	dcount++;
}

function buyShare4() {
	var buyD= parseInt(document.getElementById('BuyD').value);
	if (xVal == 0) {
		document.getElementById('BuyD').value= 0;
		return;
	}
	var cost= yVal4*buyD;
	if (cost < total) {
		total-= cost;
		curShare4+= buyD;
		document.getElementById('total').value=total;
		document.getElementById('BuyD').value= 0;
		document.getElementById('curShare4Out').value= curShare4;
		data.push({type:"buy",share:"D",shareValue:yVal4,count:buyD});
		dcount++;
	}
}

function sellShare4() {
	var sellD= parseInt(document.getElementById('SellD').value);
	if (curShare4 < sellD) {
		alert("Current share stock not enough!!!");
		document.getElementById('SellD').value= 0;
		return;
	}
	var sellPrice= sellD*yVal4;
	total+= sellPrice;
	curShare4-= sellD;
	document.getElementById('curShare4Out').value= curShare4;
	document.getElementById('SellD').value= 0;
	data.push({type:"sell",share:"D",shareValue:yVal4,count:sellD});
	dcount++;
}

window.onload = function (){

var dps1 = []; // dataPoints
var dps2= []; 
var dps3= [];
var dps4= [];

var input1= [187.29,145.6,123.5,100.38,80.1, 66.4, 64.8, 49.9, 53.2, 49.5, 50.9, 54.5, 50.1, 47.7, 26.0, 27.4, 27.6, 39.3, 41.5, 37.3, 35.4, 26.5, 26.3, 26.0, 24.0, 21.7, 22.2, 20.9];

var input2= [24.82,33.19,46.69,60.29,54.2,55.2,52.0,45.7,56.6,
75.3,71.2,82.9,88.6,87.7,113.2,146.5,158.9,162.0,242.7,279.7,316.8,440.5,458.4,519.3,494.4,480.9,627.4,597.4];

var input3= [170.1,165.6,173.8,130.7,112.6,96.0,88.2,74.4,91.2,71.6,57.8,65.2,72.0,101.3,135.2,140.4,121.8,136.3,122.1,98.9,71.9,63.3,64.4,77.2,60.5,51.3,50.2,40.8];

var input4= [269.3,312.9,317,317.7,403.8,319.7,284.3,352.1,343.7,373.5,335.3,360.8,474.3,415,344.5,329.7,267.3,322.9,321.8,297.5,263.4,269.6,247.3,226.9,224.2,217.4,244.4,235.1];

var chart1 = new CanvasJS.Chart("chartContainer1", {
	title :{
		text: "Share A"
	},
	axisY: {
		includeZero: false
	},      
	data: [{
		type: "line",
		dataPoints: dps1
	}]
});

var chart2 = new CanvasJS.Chart("chartContainer2", {
	title :{
		text: "Share B"
	},
	axisY: {
		includeZero: false
	},      
	data: [{
		type: "line",
		dataPoints: dps2
	}]
});

var chart3 = new CanvasJS.Chart("chartContainer3", {
	title :{
		text: "Share C"
	},
	axisY: {
		includeZero: false
	},      
	data: [{
		type: "line",
		dataPoints: dps3
	}]
});

var chart4 = new CanvasJS.Chart("chartContainer4", {
	title :{
		text: "Share D"
	},
	axisY: {
		includeZero: false
	},      
	data: [{
		type: "line",
		dataPoints: dps4
	}]
});

var updateChart1 = function (count) {

	for (var j = 0; j < count; j++) {
		yVal1 = input1[xVal%29];
		yVal2 = input2[xVal%29];
		yVal3 = input3[xVal%29];
		yVal4 = input4[xVal%29];
		dps1.push({
			x: xVal,
			y: yVal1
		});
		dps2.push({
			x: xVal,
			y: yVal2
		});
		dps3.push({
			x: xVal,
			y: yVal3
		});
		dps4.push({
			x: xVal,
			y: yVal4
		});
		xVal= (xVal + 1);
	}

	if (dps1.length > dataLength) {
		dps1.shift();
	}

	if (dps2.length > dataLength) {
		dps2.shift();
	}

	if (dps3.length > dataLength) {
		dps3.shift();
	}

	if (dps4.length > dataLength) {
		dps4.shift();
	}

	chart1.render();
	chart2.render();
	chart3.render();
	chart4.render();
};


var updateCharts = function (count)
{
        count = count || 1;
        if(xVal  > 29) return;
        updateChart1(count);
	  document.getElementById('total').value=total
}

updateCharts(1);
setInterval(function(){updateCharts()}, updateInterval);

}
</script>
</head>

<body  class="six" >
<div>
<div style="width:50%; height:50%; float:left">
<p id="chartContainer1" style="height: 250px; width:700px;"></p>
<input style="margin-left: 100px; width:100px; height: 40px;" type= "text" name= "BuyA" id= "BuyA" value= "0"/>
<button style="margin-left: 10px;height: 40px;" type="button" value="buyA" id="buyA" onclick="buyShare1();" >BUY</button>
<script type="text/javascript" id= "curShare"> document.write("Available shares: ")</script>
<input type="text" name="Available Shares" id="curShare1Out" style= "width:50px" readonly>
<input style="margin-left: 50px; width:100px; height: 40px;" type= "text" name= "SellA" id= "SellA" value= "0"/>
<button style="margin-left: 10px;height: 40px;" type="button" value="sellA" id="A" onclick="sellShare1();" >SELL</button>
</div>

<div style="width:50%; height:50%; float:right">
<p>
<p id="chartContainer2" style="height: 250px; width:700px;"></p>
<input style="margin-left: 100px; width:100px; height: 40px;" type= "text" name= "BuyB" id= "BuyB" value= "0"/>
<button style="margin-left: 10px;height: 40px;" type="button" value="buyB" id="buyB" onclick="buyShare2();" >BUY</button>
<script type="text/javascript" id= "curShare"> document.write("Available shares: ")</script>
<input type="text" name="Available Shares" id="curShare2Out" style= "width:50px" readonly>
<input style="margin-left: 50px; width:100px; height: 40px;" type= "text" name= "SellB" id= "SellB" value= "0"/>
<button style="margin-left: 10px;height: 40px;" type="button" value="sellB" id="sellB" onclick="sellShare2();" >SELL</button>
</p>
</div>

<div style="width:50%; height:40%; float:left">
<p id="chartContainer3" style="height: 250px; width:700px;"></p>
<input style="margin-left: 100px; width:100px; height: 40px;" type= "text" name= "BuyC" id= "BuyC" value= "0"/>
<button style="margin-left: 10px;height: 40px;" type="button" value="buyC" id="buyC" onclick="buyShare3();" >BUY</button>
<script type="text/javascript" id= "curShare"> document.write("Available shares: ")</script>
<input type="text" name="Available Shares" id="curShare3Out" style= "width:50px" readonly>
<input style="margin-left: 50px; width:100px; height: 40px;" type= "text" name= "SellC" id= "SellC" value= "0"/>
<button style="margin-left: 10px;height: 40px;" type="button" value="sellC" id="sellC" onclick="sellShare3();" >SELL</button>
</div>

<div style="width:50%; height:40%; float:right">
<p id="chartContainer4" style="height: 250px; width:700px;"></p>
<input style="margin-left: 100px; width:100px; height: 40px;" type= "text" name= "BuyD" id= "BuyD" value= "0"/>
<button style="margin-left: 10px;height: 40px;" type="button" value="buyD" id="buyD" onclick="buyShare4();" >BUY</button>
<script type="text/javascript" id= "curShare"> document.write("Available shares: ")</script>
<input type="text" name="Available Shares" id="curShare4Out" style= "width:50px" readonly>
<input style="margin-left: 50px; width:100px; height: 40px;" type= "text" name= "SellD" id= "SellD" value= "0"/>
<button style="margin-left: 10px;height: 40px;" type="button" value="sellD" id="sellD" onclick="sellShare4();" >SELL</button>
</div>

<p><label for="total" style= "margin-left: 610px;">Total:</label>
<input  style="margin-left: 20px;margin-top:35px; width:60px; height: 40px;"  type= text name= "total" id= "total" readonly/>
<button style="margin-left: 10px;height: 40px;color: red" type="button" value="save" id="save" onclick="saveData();">SAVE</button>
</p>
</div>
<div>
<script type= "text/javascript" src="script.js"></script>
</div>



